<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <title>UserFrosting: Components</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="">
    <link rel="canonical" href="//components.html">
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">
    
   <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap/css/bootstrap-custom.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <link rel="canonical" href="http://www.userfrosting.com">

    <title>UserFrosting: A secure, modern user management system based on UserCake, jQuery, and Bootstrap</title>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
        ga('create', 'UA-37689257-2', 'www.userfrosting.com');
        ga('send', 'pageview');
      
    </script>
</head>


    <body>

    <header role="banner" class="navbar navbar-default navbar-fixed-top top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" data-toggle="collapse" data-target="#collapse" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">UserFrosting</a>
    </div>
    <nav id="collapse" role="navigation" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown dropdown-primary">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class='fa fa-download'></i> Get UserFrosting <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="https://github.com/alexweissman/UserFrosting/"><i class='fa fa-github'></i> View on Github</a></li>
            <li class="divider"></li>              
            <li><a href="https://github.com/alexweissman/UserFrosting/zipball/master"><i class='fa fa-file-archive-o'></i> Download as a .zip file</a></li>
            <li><a href="https://github.com/alexweissman/UserFrosting/tarball/master"><i class='fa fa-file-archive-o'></i> Download as a tar.gz file</a></li>
          </ul>
        </li>
        <li><a href="http://uf-demo.alexanderweissman.com/">Demo</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="about.html">About</a></li>
            <li><a href="components.html">Components</a></li>
            <li><a href="features.html">Main Features</a></li>
            <li><a href="security.html">Security Features</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
          <ul class="dropdown-menu">        
            <li><a href="tutorials.html">Tutorials and Help</a></li>
            <li><a href="backend-api.html">Backend AJAX API</a></li>
            <li><a href="forms-api.html">Forms API</a></li>
          </ul>
        </li>
        <li><a href="contributors.html">Contributors</a></li>
        </ul>
      <ul class="nav navbar-nav navbar-right">  
        <li style="padding-top: 10px;"><iframe src="http://ghbtns.com/github-btn.html?user=alexweissman&repo=userfrosting&type=watch&count=true&size=large" frameborder="0" scrolling="0" width="144" height="30"></iframe></li>
      </ul>
      
    </nav>
  </div>
</header> 


    <div class="container">
      <h1 id="toc_0">Components</h1>

<div class="header-menu">
  <nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="#users">Users</a></li>
          <li><a href="#groups">Groups</a></li>
          <li><a href="#pages">Account Pages</a></li>
          <li><a href="#actions">Secure Actions</a></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav>
</div>

<h2 id="toc_1"><a name="users"></a><i class='fa fa-user'></i> Users</h2>

<p><img class="img-right" src="images/components-user.png"></p>

<p>UserFrosting is all about, well, <strong>users</strong>.  Specifically, it&#39;s for situations when you want users of your site to have an account on your site and be able to log in with a username (or email address) and password.  This is known as <strong>authentication</strong>.</p>

<p>You may also want your users to be able to manage their account information (such as changing their email address, password, or other information), or register a new account for themselves when they visit your site.  You may also want to control what individual users will see when they log into your site, and what types of things they can or cannot do when logged in.  This last concept is often referred to as <strong>authorization</strong>.</p>

<p>User accounts can be created in two ways: by another user who is authorized to create user accounts (such as site administrators), or directly through self-registration from the &quot;registration&quot; page.  This second method can be enabled or disabled by administrators through the &quot;site settings&quot; page.  Self-registered users can also be required to activate their account through an email link.  If this feature is enabled (through the &quot;email activation&quot; button in site settings), newly registered users will be emailed a link containing a unique <strong>activation token</strong>.  The user must then click this link before they will be able to log in.</p>

<p>Accounts can also be manually activated by administrators.  For more details on account registration and activation, see the &quot;Account Registration&quot; page.</p>

<p>Administrators can also <strong>edit</strong> user details, temporarily <strong>disable</strong> user accounts from the &quot;users&quot; page, or <strong>delete</strong> a user account entirely.  For more information, see the <a href="features.html#user-management">User Management</a> section.</p>

<p>There is one special account, called the <strong>root account</strong>.  The root account is the first account created during the installation process (see &quot;Installation&quot;).  It is defined as the account with <code>user_id</code> of <code>1</code>, although this can be changed in <code>models/config.php</code>.  The root account cannot be deleted, and is automatically granted permission for every action and page (see <a href="features.html#authorization">Authorization</a>).</p>

<h2 id="toc_2"><a name="groups"></a><i class='fa fa-users'></i> Groups</h2>

<p><img class="img-left" src="images/components-groups.png"></p>

<p><strong>Groups</strong> are used to control authorization for multiple users at once, as well as customize the appearance and layout of the pages that each user sees.  Each user can belong to one or more groups, but only one group will be considered the user&#39;s <strong>primary group</strong>.  The primary group is used to determine which page the user will land on when they log in, as well as the formatting for their side menu bar.  Primary group assignment can also be used as a criteria for authorization: for example, you may authorize a group of site moderators to disable user accounts, but only for users whose primary group is &quot;User&quot;.  For more details, see the <a href="features.html#authorization">Authorization</a> section.</p>

<p>Groups can be managed from the &quot;Groups&quot; page under &quot;Site Settings&quot;.  Here, one may edit group names, and set the landing page for primary members of that group.  Additionally, groups can be set as <strong>default groups</strong>.  Self-registered users are automatically added to the default groups when they create their account.  One default group can also be set as the <strong>default primary group</strong>.  Self-registered users will have their primary group set to this default group.</p>

<p>Groups can be authorized to perform certain actions or access certain pages.  Users automatically gain all the permissions associated with all groups to which they belong.  UserFrosting uses a default-deny authorization scheme, which means that users can only be denied access to an action or page by being omitted from groups that have that access.  For more information, see the <a href="components.html#authorization">Authorization</a> section.</p>

<h2 id="toc_3"><a name="pages"></a><i class='fa fa-files-o'></i> Account Pages</h2>

<p><strong>Account pages</strong> make up the navigable content of your site.  Each page is implemented as a <code>.php</code> file, and can contain PHP, HTML, and Javascript.  We recommend that you separate your visible content (HTML) from the PHP as much as possible as a best practice.  This can be done by using Javascript/AJAX to mediate interaction between your account pages and a set of backend <strong>api pages</strong>.  For more information on this, see the section <a href="features.html#api">Backend API</a>.</p>

<p>The default installation comes with the following pages:</p>

<ul>
<li><code>account_settings.php</code>: The page where users can change their email address and password.</li>
<li><code>dashboard.php</code>: A sample dashboard page for users.  Doesn&#39;t do anything currently, but could be used to display messages, a feed, or other high-importance information.</li>
<li><code>dashboard_admin.php</code>: A sample dashboard page for administrators.  Doesn&#39;t do anything currently, but could be used to display site statistics, monitor user activity, or manage other activities.</li>
<li><code>groups.php</code>: The page where administrators can manage groups.  Allows admins to create, edit, and delete groups, set default and default primary groups.</li>
<li><code>header.php</code>: Not a navigable page.  Renders the appropriate menu bars for users, usually loaded from other pages via jQuery, for example:</li>
</ul>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$(&#39;.navbar&#39;).load(&#39;header.php&#39;, function() {
    $(&#39;.navitem-dashboard&#39;).addClass(&#39;active&#39;);
});
</code></pre></div>
<ul>
<li><code>includes.php</code>: Not a navigable page.  Loads core jQuery, bootstrap, and UserFrosting javascript modules.  Also, applies appropriate CSS styles for users.</li>
<li><code>index.php</code>: The first page that users are sent to upon login.  Automatically redirects users to their home page.</li>
<li><code>logout.php</code>: Logs the current user out.  We may move this to the <code>api</code> directory soon.</li>
<li><code>site_authorization.php</code>: The page where administrators can manage user, group, and page authorization.  See <a href="features.html#authorization">Authorization</a> for more information.</li>
<li><code>site_settings.php</code>: The page where administrators can change settings for the site, including site name, enable or disable account registration, email login, and more.</li>
<li><code>user_details.php</code>: The page where administrators can view and edit details for a user, including group membership.  Takes the GET parameter <code>id</code>, where <code>id</code> is the id of the user to be displayed. </li>
<li><code>users.php</code>: The page where administrators can view a list of all users, edit their account information, activate, disable, and delete accounts.</li>
</ul>

<p>These are located in the <code>account</code> subdirectory.  You can manually add additional subdirectories in <code>models/config.php</code> by adding the path to the <code>$page_include_paths</code> array.</p>

<h2 id="toc_4"><a name="actions"></a><i class='fa fa-lock'></i> Secure Actions</h2>

<p>Like UserCake, the first version of UserFrosting was only able to control access at the page level.  Each group either had or didn&#39;t have access to a particular page.  When I started implementing the tutor management system for <a href="http://bloomingtontutors.com">my company</a>, I quickly realized that I needed to be able to allow different users access to different resources on the same page.  Furthermore, I realized that I needed a user&#39;s authorization to depend on certain contexts.  For example, I wanted to allow tutors to edit a student&#39;s details, but only if they had been assigned to that student.  Of course, this could be implemented with something like:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">if (hasStudent($loggedInUser-&gt;user_id, $student_id)){
  updateUser($student_id, ...);
}
</code></pre></div>
<p>But I didn&#39;t want to hard code these rules throughout my site, and then have to manually update each one if I wanted to change permission rules.  I needed a solution that allowed contextual access control, with all of the rules kept in one place.</p>

<p>Enter the concept of <strong>secure actions</strong>.  Secure actions are functions that perform some atomic operation, such as modifying a user, assigning a user to a group, or viewing a list of users.  They are special because, when they are called, they first check to see if the user who called them is authorized to perform that action with the specified parameters.  This is achieved through PHP&#39;s reflective programming API, which allows a running to script to &quot;know thyself.&quot;  A secure action calls the <code>checkActionPermissionSelf</code> function, which looks up the name of the function in the database to see if the current user (or their groups) is authorized to call it.  If so, the parameters supplied to the function are checked against one or more <strong>permits</strong>.  Permits are functions that check if supplied parameters meet certain criteria, and then return a true/false value.  For example, the permit <code>isLoggedInUser(user_id)</code> checks to see whether the supplied <code>user_id</code> matches the <code>user_id</code> of the currently logged in user.  If (and only if) the user passes all of the required permits for that action, then the secure function proceeds to execute.</p>

<p>For more information, see the <a href="features.html#authorization">Authorization</a> section.</p>

                <!-- FOOTER -->
      <footer>
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p>&copy; Created by <a href="https://github.com/alexweissman" target="_blank">Alexander Weissman</a> Licensed under the
        <a href="http://opensource.org/licenses/MIT" target="_blank">MIT License</a></p>
      </footer>
      
    </div>
        <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="jquery/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    </body>
</html>